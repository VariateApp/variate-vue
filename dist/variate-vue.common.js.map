{"version":3,"file":"variate-vue.common.js","sources":["../src/config/console.js","../src/lang/version.js","../src/lang/debug.js","../src/variate.js","../src/helpers.js","../src/index.js"],"sourcesContent":["export const name = 'Variate Vue';\n\nexport const styles = {\n    brand: \"background: rgba(143, 127, 224, 1); color: white; font-weight: 500; border-radius: 3px 0 0 3px; padding: 1px 2px;\",\n    error: \"background: #e17055; color: white; font-weight: 500; border-radius: 3px 0 0 3px; padding: 1px 2px;\",\n    warning: \"background: #fdcb6e; color: white; font-weight: 500; border-radius: 3px 0 0 3px; padding: 1px 2px;\",\n    type: \"background: #424242; color: white; font-weight: 400; padding: 1px 2px; border-radius: 0 3px 3px 0;\",\n    message: \"background: transparent; font-weight: 400;\"\n}\n","import { name, styles } from '../config/console';\n\nexport default {\n    show: function() {\n        console.log(\n            `%c ${name} %c __VERSION__ `,\n            styles.brand,\n            styles.type\n        );\n    },\n}\n","// Components\nexport const LOAD_COMPONENT= `[COMPONENT] %s`;\nexport const LOAD_COMPONENT_EXPERIMENTS = `Running experiments:`;\n","import Variate from '@variate/engine';\nimport version from './lang/version';\nimport * as debug from './lang/debug';\n\nexport function install(Vue, options) {\n    options.debug && version.show();\n    // 3. inject some component options\n    Vue.mixin({\n        props: {\n            variateId: {\n                type: String,\n                default: () => null\n            }\n        },\n        computed: {\n            variateComponentName() {\n                return this.variateId || this.$options._componentTag;\n            },\n            variateMainBucket() {\n                return this.$variate.getMainTrafficBucket();\n            },\n            variateComponent() {\n                if (typeof this.$variate.components[this.variateComponentName] !== 'undefined') {\n                    return this.$variate.components[this.variateComponentName];\n                }\n\n                return {};\n            },\n            variateBucket() {\n                return this.variateComponent.bucket;\n            },\n            variateExperiments() {\n                return this.variateComponent.experiments;\n            },\n            variateAttributes() {\n                return this.variateComponent.attributes || {};\n            },\n        },\n        created() {\n            if (typeof this.variateExperiments !== 'undefined') {\n                options.debug && console.groupCollapsed(debug.LOAD_COMPONENT, this.variateComponentName);\n                options.debug && console.log(debug.LOAD_COMPONENT_EXPERIMENTS);\n                options.debug && console.log(this.variateExperiments);\n                options.debug && console.groupEnd();\n            }\n        },\n    });\n\n    Vue.prototype.$variate = new Variate(options);\n}\n","export const mapStyles = normalizeNamespace((namespace, map) => {\n    let styles = namespace || 'styles';\n    let response = {};\n\n    if(Array.isArray(map)) {\n        response[styles] = normalizeMap(map).map(({ key, val }) => {\n            const property = key.split(/(?=[A-Z])/).map((value) => value.toLowerCase()).join('-');\n            return `${property}: ${val}`;\n        });\n\n        return response;\n    }\n\n    response[styles] =  function() {\n        return normalizeMap(map).map(({ key, val }) => {\n            const property = key.split(/(?=[A-Z])/).map((value) => value.toLowerCase()).join('-');\n            return `${property}: ${val.replace(/%s/g, () => this[key] || key )}`;\n        }).join('; ');\n    };\n\n    return response;\n});\n\n/**\n *\n * @param attributes\n */\nexport const mapAttributes = (attributes) => {\n    let computed = {};\n\n    normalizeMap(attributes).forEach(({ key, val }) => {\n        computed[key] = function() {\n            if(!this.variateAttributes) {\n                return null;\n            }\n\n            return this.variateAttributes[key] || this.variateAttributes[val];\n        };\n    });\n\n    return computed;\n};\n\n/**\n * Return a function expect two param contains namespace and map. it will normalize the namespace and then the param's function will handle the new namespace and the map.\n * @param {Function} fn\n * @return {Function}\n */\nfunction normalizeNamespace (fn) {\n    return (namespace, map) => {\n        if (typeof namespace !== 'string') {\n            map = namespace\n            namespace = ''\n        }\n\n        return fn(namespace, map)\n    }\n}\n\n/**\n * Normalize the map\n * normalizeMap([1, 2, 3]) => [ { key: 1, val: 1 }, { key: 2, val: 2 }, { key: 3, val: 3 } ]\n * normalizeMap({a: 1, b: 2, c: 3}) => [ { key: 'a', val: 1 }, { key: 'b', val: 2 }, { key: 'c', val: 3 } ]\n * @param {Array|Object} map\n * @return {Object}\n */\nfunction normalizeMap(map) {\n    return Array.isArray(map)\n        ? map.map(key => ({ key, val: key }))\n        : Object.keys(map).map(key => ({ key, val: map[key] }));\n}\n\nexport default mapAttributes;\n","import { install } from './variate';\nimport { mapAttributes, mapStyles } from './helpers';\n\nexport {\n    mapAttributes,\n    mapStyles\n}\n\nexport default {\n    install,\n    mapAttributes,\n    mapStyles,\n}\n"],"names":["name","styles","brand","error","warning","type","message","show","console","log","LOAD_COMPONENT","LOAD_COMPONENT_EXPERIMENTS","install","Vue","options","debug","version","mixin","props","variateId","String","default","computed","variateComponentName","$options","_componentTag","variateMainBucket","$variate","getMainTrafficBucket","variateComponent","components","variateBucket","bucket","variateExperiments","experiments","variateAttributes","attributes","created","groupCollapsed","groupEnd","prototype","Variate","mapStyles","normalizeNamespace","namespace","map","response","Array","isArray","normalizeMap","key","val","property","split","value","toLowerCase","join","replace","mapAttributes","forEach","fn","Object","keys"],"mappings":"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"}